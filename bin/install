#!/bin/bash
# This script moves and replaces the original .vim and .vimrc. It then installs
# Vundle so that the plugins in the new .vimrc file can be downloaded.

# Get the absolute path to our vimrc file.
script_dir=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
vim_config_dir=${script_dir%/*}
vimrc_path=${vim_config_dir%%/}/vimrc

if [[ -e "$HOME/.vimrc" ]]; then
  if [[ -e "$HOME/.vimrc-original" ]]; then
    echo .vimrc-original already exists! Move it before installing.
    exit
  fi

  mv $HOME/.vimrc $HOME/.vimrc-original
  echo Moved original .vimrc to .vimrc-original.
fi

if [[ -d "$HOME/.vim" ]]; then
  if [[ -d "$HOME/.vim-original" ]]; then
    mv $HOME/.vimrc-original $HOME/.vimrc
    echo .vim-original already exists! Move it before installing.
    echo Moved .vimrc-original back to .vimrc.
    exit
  fi

  mv $HOME/.vim $HOME/.vim-original
  echo Moved original .vim to .vim-original.
fi

# Create a symbolic link file with our vimrc in the root.
ln -s $vimrc_path $HOME/.vimrc
echo Created new .vimrc file.

mkdir $HOME/.vim
mkdir $HOME/.vim/bundle
mkdir $HOME/.vim/tmp
echo Created new .vim directory.

echo Installing Vundle...
git clone https://github.com/gmarik/Vundle.vim.git $HOME/.vim/bundle/Vundle.vim

vim +PluginInstall +qa
echo Installed vim plugins.
